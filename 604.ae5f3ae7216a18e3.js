"use strict";(self.webpackChunktestapp=self.webpackChunktestapp||[]).push([[604],{3657:($,F,u)=>{u.d(F,{R:()=>p});var r=u(655),_=u(5980),P=u(2011),O=u(2717),M=u(6895);class p{constructor(y){this.store=y}increment(){this.store.dispatch(new P.MP)}decrement(){this.store.dispatch(new P.FB)}}p.\u0275fac=function(y){return new(y||p)(O.Y36(_.yh))},p.\u0275cmp=O.Xpm({type:p,selectors:[["app-counter"]],decls:7,vars:3,consts:[[3,"click"]],template:function(y,S){1&y&&(O.TgZ(0,"p"),O._uU(1),O.ALo(2,"async"),O.qZA(),O.TgZ(3,"button",0),O.NdJ("click",function(){return S.increment()}),O._uU(4,"Increment"),O.qZA(),O.TgZ(5,"button",0),O.NdJ("click",function(){return S.decrement()}),O._uU(6,"Decrement"),O.qZA()),2&y&&(O.xp6(1),O.hij("counter works! the count is ",O.lcZ(2,1,S.count$),""))},dependencies:[M.Ov]}),(0,r.gn)([(0,_.Ph)(P.uT)],p.prototype,"count$",void 0)},7848:($,F,u)=>{u.d(F,{k:()=>M});var r=u(6895),_=u(1035),P=u(2011),O=u(2717);let M=(()=>{class p{}return p.\u0275fac=function(y){return new(y||p)},p.\u0275mod=O.oAB({type:p}),p.\u0275inj=O.cJS({providers:[{provide:_._F,useValue:[P.MP,P.FB],multi:!0}],imports:[r.ez]}),p})()},2011:($,F,u)=>{u.d(F,{FB:()=>M,MP:()=>O,uT:()=>p});var r=u(655),_=u(5980),P=u(2717);let O=(()=>{class g{}return g.type="[Counter] Increment",g})(),M=(()=>{class g{}return g.type="[Counter] Decrement",g})(),p=class{change(y,S){S instanceof O?y.setState(y.getState()+1):S instanceof M&&y.setState(y.getState()-1)}};p.\u0275fac=function(y){return new(y||p)},p.\u0275prov=P.Yz7({token:p,factory:p.\u0275fac}),(0,r.gn)([(0,_.aU)([O,M])],p.prototype,"change",null),p=(0,r.gn)([(0,_.ZM)({name:"counter",defaults:0})],p)},2689:($,F,u)=>{u.d(F,{ns:()=>L});var r=u(2717),_=u(5980),P=u(262),O=u(8505);const y=new r.OlP("NGXS_DEVTOOLS_OPTIONS");let U=(()=>{class A{constructor(T,I,G){this._options=T,this._injector=I,this._ngZone=G,this.devtoolsExtension=null,this.globalDevtools=r.dqk.__REDUX_DEVTOOLS_EXTENSION__||r.dqk.devToolsExtension,this.unsubscribe=null,this.connect()}ngOnDestroy(){null!==this.unsubscribe&&this.unsubscribe(),this.globalDevtools&&this.globalDevtools.disconnect()}get store(){return this._injector.get(_.yh)}handle(T,I,G){return!this.devtoolsExtension||this._options.disabled?G(T,I):G(T,I).pipe((0,P.K)(W=>{const K=this.store.snapshot();throw this.sendToDevTools(T,I,K),W}),(0,O.b)(W=>{this.sendToDevTools(T,I,W)}))}sendToDevTools(T,I,G){const W=(0,_.f4)(I);"@@INIT"===W?this.devtoolsExtension.init(T):this.devtoolsExtension.send(Object.assign({},I,{action:null,type:W}),G)}dispatched(T){if("DISPATCH"===T.type){if("JUMP_TO_ACTION"===T.payload.type||"JUMP_TO_STATE"===T.payload.type){const I=JSON.parse(T.state);I.router&&I.router.trigger&&(I.router.trigger="devtools"),this.store.reset(I)}else if("TOGGLE_ACTION"===T.payload.type)console.warn("Skip is not supported at this time.");else if("IMPORT_STATE"===T.payload.type){const{actionsById:I,computedStates:G,currentStateIndex:W}=T.payload.nextLiftedState;this.devtoolsExtension.init(G[0].state),Object.keys(I).filter(K=>"0"!==K).forEach(K=>this.devtoolsExtension.send(I[K],G[K].state)),this.store.reset(G[W].state)}}else if("ACTION"===T.type){const I=JSON.parse(T.payload);this.store.dispatch(I)}}connect(){!this.globalDevtools||this._options.disabled||(this.devtoolsExtension=this._ngZone.runOutsideAngular(()=>this.globalDevtools.connect(this._options)),this.unsubscribe=this.devtoolsExtension.subscribe(T=>{("DISPATCH"===T.type||"ACTION"===T.type)&&this._ngZone.run(()=>{this.dispatched(T)})}))}}return A.\u0275fac=function(T){return new(T||A)(r.LFG(y),r.LFG(r.zs3),r.LFG(r.R0b))},A.\u0275prov=r.Yz7({token:A,factory:A.\u0275fac}),A})();function V(A){return Object.assign({name:"NGXS"},A)}const H=new r.OlP("USER_OPTIONS");let L=(()=>{class A{static forRoot(T){return{ngModule:A,providers:[{provide:_.fN,useClass:U,multi:!0},{provide:H,useValue:T},{provide:y,useFactory:V,deps:[H]}]}}}return A.\u0275fac=function(T){return new(T||A)},A.\u0275mod=r.oAB({type:A}),A.\u0275inj=r.cJS({}),A})()},5980:($,F,u)=>{u.d(F,{aU:()=>Ve,XP:()=>me,fN:()=>ce,$l:()=>z,Ph:()=>qe,ZM:()=>Ye,yh:()=>_t,f4:()=>lt});var r=u(2717),_=u(7579),P=u(6063);class O extends _.x{constructor(n=1/0,e=1/0,s=P.l){super(),this._bufferSize=n,this._windowTime=e,this._timestampProvider=s,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,n),this._windowTime=Math.max(1,e)}next(n){const{isStopped:e,_buffer:s,_infiniteTimeWindow:o,_timestampProvider:c,_windowTime:f}=this;e||(s.push(n),!o&&s.push(c.now()+f)),this._trimBuffer(),super.next(n)}_subscribe(n){this._throwIfClosed(),this._trimBuffer();const e=this._innerSubscribe(n),{_infiniteTimeWindow:s,_buffer:o}=this,c=o.slice();for(let f=0;f<c.length&&!n.closed;f+=s?1:2)n.next(c[f]);return this._checkFinalizedStatuses(n),e}_trimBuffer(){const{_bufferSize:n,_timestampProvider:e,_buffer:s,_infiniteTimeWindow:o}=this,c=(o?1:2)*n;if(n<1/0&&c<s.length&&s.splice(0,s.length-c),!o){const f=e.now();let m=0;for(let v=1;v<s.length&&s[v]<=f;v+=2)m=v;m&&s.splice(0,m+1)}}}let p=(()=>{class t{constructor(){this.bootstrap$=new O(1)}get appBootstrapped$(){return this.bootstrap$.asObservable()}bootstrap(){this.bootstrap$.next(!0),this.bootstrap$.complete()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})();function g(t,n){return t===n}function y(t,n,e){if(null===n||null===e||n.length!==e.length)return!1;const s=n.length;for(let o=0;o<s;o++)if(!t(n[o],e[o]))return!1;return!0}const b=new r.OlP("INITIAL_STATE_TOKEN");let U=(()=>{class t{static set(e){this.value=e}static pop(){const e=this.value;return this.value={},e}}return t.value={},t})();const V=new r.OlP("Internals.StateContextFactory"),H=new r.OlP("Internals.StateFactory");var L=u(6895),A=u(8306);class ot extends _.x{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const e=super._subscribe(n);return!e.closed&&n.next(this._value),e}getValue(){const{hasError:n,thrownError:e,_value:s}=this;if(n)throw e;return this._throwIfClosed(),s}next(n){super.next(this._value=n)}}var T=u(7669),I=u(457);function G(...t){const n=(0,T.yG)(t);return(0,I.D)(t,n)}const{isArray:W}=Array,{getPrototypeOf:K,prototype:Ht,keys:yt}=Object;var rt=u(8421),Y=u(5403),Kt=u(3268);function St(t,n){return t.reduce((e,s,o)=>(e[s]=n[o],e),{})}function it(...t){const n=(0,T.jO)(t),{args:e,keys:s}=function Tt(t){if(1===t.length){const n=t[0];if(W(n))return{args:n,keys:null};if(function Wt(t){return t&&"object"==typeof t&&K(t)===Ht}(n)){const e=yt(n);return{args:e.map(s=>n[s]),keys:e}}}return{args:t,keys:null}}(t),o=new A.y(c=>{const{length:f}=e;if(!f)return void c.complete();const m=new Array(f);let v=f,x=f;for(let D=0;D<f;D++){let N=!1;(0,rt.Xf)(e[D]).subscribe((0,Y.x)(c,k=>{N||(N=!0,x--),m[D]=k},()=>v--,void 0,()=>{(!v||!N)&&(x||c.next(s?St(s,m):m),c.complete())}))}});return n?o.pipe((0,Kt.Z)(n)):o}var Ct=u(576);function nt(t,n){const e=(0,Ct.m)(t)?t:()=>t,s=o=>o.error(e());return new A.y(n?o=>n.schedule(s,0,o):s)}var vt=u(515),It=u(4408),mt=u(7565);const Vt=new class Ot extends mt.v{}(class Q extends It.o{constructor(n,e){super(n,e),this.scheduler=n,this.work=e}schedule(n,e=0){return e>0?super.schedule(n,e):(this.delay=e,this.state=n,this.scheduler.flush(this),this)}execute(n,e){return e>0||this.closed?super.execute(n,e):this._execute(n,e)}requestAsyncId(n,e,s=0){return null!=s&&s>0||null==s&&this.delay>0?super.requestAsyncId(n,e,s):(n.flush(this),0)}});var q=u(9300),at=u(4004),Xt=u(3099);function tt(t,n,e){let s,o=!1;return t&&"object"==typeof t?({bufferSize:s=1/0,windowTime:n=1/0,refCount:o=!1,scheduler:e}=t):s=t??1/0,(0,Xt.B)({connector:()=>new O(s,n,e),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:o})}var et=u(4482);function Et(t){return t<=0?()=>vt.E:(0,et.e)((n,e)=>{let s=0;n.subscribe((0,Y.x)(e,o=>{++s<=t&&(e.next(o),t<=s&&e.complete())}))})}function xt(t,n){return n?e=>e.pipe(xt((s,o)=>(0,rt.Xf)(t(s,o)).pipe((0,at.U)((c,f)=>n(s,c,o,f))))):(0,et.e)((e,s)=>{let o=0,c=null,f=!1;e.subscribe((0,Y.x)(s,m=>{c||(c=(0,Y.x)(s,void 0,()=>{c=null,f&&s.complete()}),(0,rt.Xf)(t(m,o++)).subscribe(c))},()=>{f=!0,!c&&s.complete()}))})}var ct=u(5577);function Pt(t){return(0,et.e)((n,e)=>{let s=!1;n.subscribe((0,Y.x)(e,o=>{s=!0,e.next(o)},()=>{s||e.next(t),e.complete()}))})}var Ft=u(262),wt=u(5032);function Nt(t){return(0,et.e)((n,e)=>{(0,rt.Xf)(t).subscribe((0,Y.x)(e,()=>e.complete(),wt.Z)),!e.closed&&n.subscribe(e)})}var Zt=u(8505),Mt=u(5363),Rt=u(4671);function Jt(t,n){return t===n}class B{constructor(n,e){this._ngZone=n,this._platformId=e}enter(n){return(0,L.PM)(this._platformId)?this.runInsideAngular(n):this.runOutsideAngular(n)}leave(n){return this.runInsideAngular(n)}runInsideAngular(n){return r.R0b.isInAngularZone()?n():this._ngZone.run(n)}runOutsideAngular(n){return r.R0b.isInAngularZone()?this._ngZone.runOutsideAngular(n):n()}}B.\u0275fac=function(n){return new(n||B)(r.LFG(r.R0b),r.LFG(r.Lbi))},B.\u0275prov=r.Yz7({token:B,factory:B.\u0275fac,providedIn:"root"}),B.ngInjectableDef=(0,r.Ez6)({factory:function(){return new B((0,r.f3M)(r.R0b),(0,r.f3M)(r.Lbi))},token:B,providedIn:"root"});const X=new r.OlP("ROOT_STATE_TOKEN"),Gt=new r.OlP("FEATURE_STATE_TOKEN"),ce=new r.OlP("NGXS_PLUGINS"),Z="NGXS_META",ue="NGXS_OPTIONS_META";let ut=(()=>{class t{constructor(){this.defaultsState={},this.selectorOptions={injectContainerState:!0,suppressErrors:!0},this.compatibility={strictContentSecurityPolicy:!1},this.executionStrategy=B}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})();class Oe{constructor(n,e,s){this.previousValue=n,this.currentValue=e,this.firstChange=s}}class J{enter(n){return n()}leave(n){return n()}}J.\u0275fac=function(n){return new(n||J)},J.\u0275prov=r.Yz7({token:J,factory:J.\u0275fac,providedIn:"root"}),J.ngInjectableDef=(0,r.Ez6)({factory:function(){return new J},token:J,providedIn:"root"});const le=new r.OlP("USER_PROVIDED_NGXS_EXECUTION_STRATEGY"),Ee=new r.OlP("NGXS_EXECUTION_STRATEGY",{providedIn:"root",factory:()=>{const t=(0,r.f3M)(r.gxx),n=t.get(le);return t.get(n||(typeof r.dqk.Zone<"u"?B:J))}});function lt(t){return t.constructor&&t.constructor.type?t.constructor.type:t.type}const fe=(t,n,e)=>{t=Object.assign({},t);const s=n.split("."),o=s.length-1;return s.reduce((c,f,m)=>(c[f]=m===o?e:Array.isArray(c[f])?c[f].slice():Object.assign({},c[f]),c&&c[f]),t),t},Ut=(t,n)=>n.split(".").reduce((e,s)=>e&&e[s],t),te=t=>t&&"object"==typeof t&&!Array.isArray(t),ee=(t,...n)=>{if(!n.length)return t;const e=n.shift();if(te(t)&&te(e))for(const s in e)te(e[s])?(t[s]||Object.assign(t,{[s]:{}}),ee(t[s],e[s])):Object.assign(t,{[s]:e[s]});return ee(t,...n)};function ne(t){if(!t.hasOwnProperty(Z)){const n={name:null,actions:{},defaults:{},path:null,makeRootSelector:e=>e.getStateGetter(n.name),children:[]};Object.defineProperty(t,Z,{value:n})}return ft(t)}function ft(t){return t[Z]}function de(t,n){return n&&n.compatibility&&n.compatibility.strictContentSecurityPolicy?function Me(t){const n=t.slice();return e=>n.reduce((s,o)=>s&&s[o],e)}(t):function De(t){const n=t;let e="store."+n[0],s=0;const o=n.length;let c=e;for(;++s<o;)c=c+" && "+(e=e+"."+n[s]);return new Function("store","return "+c+";")}(t)}function he(t,n){const e=Ut(n.currentAppState,t.path),s=Ut(n.newAppState,t.path);return new Oe(e,s,!t.isInitialised)}function xe(...t){return function dt(t,n,e=we){const s=function Ne(t){return t.reduce((n,e)=>(n[lt(e)]=!0,n),{})}(t),o=n&&function Re(t){return t.reduce((n,e)=>(n[e]=!0,n),{})}(n);return function(c){return c.pipe(function Pe(t,n){return(0,q.h)(e=>{const s=lt(e.action);return t[s]&&(!n||n[e.status])})}(s,o),e())}}(t,["DISPATCHED"])}function we(){return(0,at.U)(t=>t.action)}function Dt(t){return n=>new A.y(e=>n.subscribe({next(s){t.leave(()=>e.next(s))},error(s){t.leave(()=>e.error(s))},complete(){t.leave(()=>e.complete())}}))}let Bt=(()=>{class t{constructor(e){this._executionStrategy=e}enter(e){return this._executionStrategy.enter(e)}leave(e){return this._executionStrategy.leave(e)}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(Ee))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})();class be extends _.x{constructor(){super(...arguments),this._itemQueue=[],this._busyPushingNext=!1}next(n){if(this._busyPushingNext)this._itemQueue.unshift(n);else{for(this._busyPushingNext=!0,super.next(n);this._itemQueue.length>0;){const e=this._itemQueue.pop();super.next(e)}this._busyPushingNext=!1}}}let kt=(()=>{class t extends be{}return t.\u0275fac=function(){let n;return function(s){return(n||(n=r.n5z(t)))(s||t)}}(),t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})(),Le=(()=>{class t extends A.y{constructor(e,s){super(o=>{const c=e.pipe(Dt(s)).subscribe({next:f=>o.next(f),error:f=>o.error(f),complete:()=>o.complete()});o.add(c)})}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(kt),r.LFG(Bt))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})();const pe=t=>(...n)=>t.shift()(...n,(...s)=>pe(t)(...s));let jt=(()=>{class t extends ot{constructor(){super({})}ngOnDestroy(){this.complete()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})(),re=(()=>{class t{constructor(e,s){this._parentManager=e,this._pluginHandlers=s,this.plugins=[],this.registerHandlers()}get rootPlugins(){return this._parentManager&&this._parentManager.plugins||this.plugins}registerHandlers(){const e=this.getPluginHandlers();this.rootPlugins.push(...e)}getPluginHandlers(){return(this._pluginHandlers||[]).map(s=>s.handle?s.handle.bind(s):s)}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(t,12),r.LFG(ce,8))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})(),ie=(()=>{class t extends _.x{}return t.\u0275fac=function(){let n;return function(s){return(n||(n=r.n5z(t)))(s||t)}}(),t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})(),ge=(()=>{class t{constructor(e,s,o,c,f,m){this._injector=e,this._actions=s,this._actionResults=o,this._pluginManager=c,this._stateStream=f,this._ngxsExecutionStrategy=m}dispatch(e){const s=this._ngxsExecutionStrategy.enter(()=>this.dispatchByEvents(e));return s.subscribe({error:o=>this._ngxsExecutionStrategy.leave(()=>{try{this._errorHandler=this._errorHandler||this._injector.get(r.qLn),this._errorHandler.handleError(o)}catch{}})}),s.pipe(Dt(this._ngxsExecutionStrategy))}dispatchByEvents(e){return Array.isArray(e)?0===e.length?G(this._stateStream.getValue()):it(e.map(s=>this.dispatchSingle(s))):this.dispatchSingle(e)}dispatchSingle(e){const s=this._stateStream.getValue();return pe([...this._pluginManager.plugins,(c,f)=>{c!==s&&this._stateStream.next(c);const m=this.getActionResultStream(f);return m.subscribe(v=>this._actions.next(v)),this._actions.next({action:f,status:"DISPATCHED"}),this.createDispatchObservable(m)}])(s,e).pipe(tt())}getActionResultStream(e){return this._actionResults.pipe((0,q.h)(s=>s.action===e&&"DISPATCHED"!==s.status),Et(1),tt())}createDispatchObservable(e){return e.pipe(xt(s=>{switch(s.status){case"SUCCESSFUL":return G(this._stateStream.getValue());case"ERRORED":return nt(s.error);default:return vt.E}})).pipe(tt())}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(r.zs3),r.LFG(kt),r.LFG(ie),r.LFG(re),r.LFG(jt),r.LFG(Bt))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})(),ht=(()=>{class t{constructor(e,s,o){this._stateStream=e,this._dispatcher=s,this._config=o}getRootStateOperations(){return{getState:()=>this._stateStream.getValue(),setState:s=>this._stateStream.next(s),dispatch:s=>this._dispatcher.dispatch(s)}}setStateToTheCurrentWithNew(e){const s=this.getRootStateOperations(),o=s.getState();s.setState(Object.assign({},o,e.defaults))}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(jt),r.LFG(ge),r.LFG(ut))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})();let zt=(()=>{class t{constructor(e){this._internalStateOperations=e}createStateContext(e){const s=this._internalStateOperations.getRootStateOperations();function o(v){return Ut(v,e.path)}function c(v,x){const D=fe(v,e.path,x),N=e.instance;if(N.ngxsOnChanges){const k=he(e,{currentAppState:v,newAppState:D});N.ngxsOnChanges(k)}return s.setState(D),D}function f(v,x){return c(v,x(o(v)))}return{getState:()=>o(s.getState()),patchState:v=>f(s.getState(),function Ge(t){return n=>{Array.isArray(t)?function C(){throw new Error("Patching arrays is not supported.")}():"object"!=typeof t&&function w(){throw new Error("Patching primitives is not supported.")}();const e=Object.assign({},n);for(const s in t)e[s]=t[s];return e}}(v)),setState(v){const x=s.getState();return function m(v){return"function"==typeof v}(v)?f(x,v):c(x,v)},dispatch:v=>s.dispatch(v)}}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(ht))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})();new RegExp("^[a-zA-Z0-9_]+$");let pt=(()=>{class t{constructor(e,s,o,c,f,m,v){this._injector=e,this._config=s,this._parentFactory=o,this._actions=c,this._actionResults=f,this._stateContextFactory=m,this._initialState=v,this._actionsSubscription=null,this._states=[],this._statesByName={},this._statePaths={},this.getRuntimeSelectorContext=function S(t,n=g){let e=null,s=null;function o(){return y(n,e,arguments)||(s=t.apply(null,arguments)),e=arguments,s}return o.reset=function(){e=null,s=null},o}(()=>{const x=this;function D(k){const j=x.statePaths[k];return j?de(j.split("."),x._config):null}return this._parentFactory?this._parentFactory.getRuntimeSelectorContext():{getStateGetter(k){let j=D(k);return j||((...gt)=>(j||(j=D(k)),j?j(...gt):void 0))},getSelectorOptions:k=>Object.assign({},x._config.selectorOptions,k||{})}})}get states(){return this._parentFactory?this._parentFactory.states:this._states}get statesByName(){return this._parentFactory?this._parentFactory.statesByName:this._statesByName}get statePaths(){return this._parentFactory?this._parentFactory.statePaths:this._statePaths}static cloneDefaults(e){let s={};return s=Array.isArray(e)?e.slice():function Ie(t){return"object"==typeof t&&null!==t||"function"==typeof t}(e)?Object.assign({},e):void 0===e?{}:e,s}ngOnDestroy(){this._actionsSubscription.unsubscribe()}add(e){const{newStates:s}=this.addToStatesMap(e);if(!s.length)return[];const o=function _e(t){const n=e=>t.find(o=>o===e)[Z].name;return t.reduce((e,s)=>{const{name:o,children:c}=s[Z];return e[o]=(c||[]).map(n),e},{})}(s),c=function Ce(t){const n=[],e={},s=(o,c=[])=>{Array.isArray(c)||(c=[]),c.push(o),e[o]=!0,t[o].forEach(f=>{e[f]||s(f,c.slice(0))}),n.indexOf(o)<0&&n.push(o)};return Object.keys(t).forEach(o=>s(o)),n.reverse()}(o),f=function Te(t,n={}){const e=(s,o)=>{for(const c in s)if(s.hasOwnProperty(c)&&s[c].indexOf(o)>=0){const f=e(s,c);return null!==f?`${f}.${c}`:c}return null};for(const s in t)if(t.hasOwnProperty(s)){const o=e(t,s);n[s]=o?`${o}.${s}`:s}return n}(o),m=function Ae(t){return t.reduce((n,e)=>(n[e[Z].name]=e,n),{})}(s),v=[];for(const x of c){const D=m[x],N=f[x],k=D[Z];this.addRuntimeInfoToMeta(k,N);const j={name:x,path:N,isInitialised:!1,actions:k.actions,instance:this._injector.get(D),defaults:t.cloneDefaults(k.defaults)};this.hasBeenMountedAndBootstrapped(x,N)||v.push(j),this.states.push(j)}return v}addAndReturnDefaults(e){const o=this.add(e||[]);return{defaults:o.reduce((f,m)=>fe(f,m.path,m.defaults),{}),states:o}}connectActionHandlers(){if(null!==this._actionsSubscription)return;const e=new _.x;this._actionsSubscription=this._actions.pipe((0,q.h)(s=>"DISPATCHED"===s.status),(0,ct.z)(s=>{e.next(s);const o=s.action;return this.invokeActions(e,o).pipe((0,at.U)(()=>({action:o,status:"SUCCESSFUL"})),Pt({action:o,status:"CANCELED"}),(0,Ft.K)(c=>G({action:o,status:"ERRORED",error:c})))})).subscribe(s=>this._actionResults.next(s))}invokeActions(e,s){const o=lt(s),c=[];for(const f of this.states){const m=f.actions[o];if(m)for(const v of m){const x=this._stateContextFactory.createStateContext(f);try{let D=f.instance[v.fn](x,s);D instanceof Promise&&(D=(0,I.D)(D)),D instanceof A.y?(D=D.pipe((0,ct.z)(N=>N instanceof Promise?(0,I.D)(N):N instanceof A.y?N:G(N)),Pt({})),v.options.cancelUncompleted&&(D=D.pipe(Nt(e.pipe(xe(s)))))):D=G({}).pipe(tt()),c.push(D)}catch(D){c.push(nt(D))}}}return c.length||c.push(G({})),it(c)}addToStatesMap(e){const s=[],o=this.statesByName;for(const c of e){const f=ft(c).name;!o[f]&&(s.push(c),o[f]=c)}return{newStates:s}}addRuntimeInfoToMeta(e,s){this.statePaths[e.name]=s,e.path=s}hasBeenMountedAndBootstrapped(e,s){const o=void 0!==Ut(this._initialState,s);return this.statesByName[e]&&o}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(r.zs3),r.LFG(ut),r.LFG(t,12),r.LFG(kt),r.LFG(ie),r.LFG(zt),r.LFG(b,8))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})(),ae=(()=>{class t{constructor(e,s,o){this.internalStateOperations=e,this.stateContextFactory=s,this.bootstrapper=o}ngxsBootstrap(e,s){this.internalStateOperations.getRootStateOperations().dispatch(e).pipe((0,q.h)(()=>!!s),(0,Zt.b)(()=>this.invokeInit(s.states)),(0,ct.z)(()=>this.bootstrapper.appBootstrapped$),(0,q.h)(o=>!!o)).subscribe(()=>this.invokeBootstrap(s.states))}invokeInit(e){for(const s of e){const o=s.instance;if(o.ngxsOnChanges){const m=he(s,{currentAppState:{},newAppState:this.internalStateOperations.getRootStateOperations().getState()});o.ngxsOnChanges(m)}o.ngxsOnInit&&o.ngxsOnInit(this.getStateContext(s)),s.isInitialised=!0}}invokeBootstrap(e){for(const s of e){const o=s.instance;o.ngxsAfterBootstrap&&o.ngxsAfterBootstrap(this.getStateContext(s))}}getStateContext(e){return this.stateContextFactory.createStateContext(e)}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(ht),r.LFG(zt),r.LFG(p))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})();let _t=(()=>{class t{constructor(e,s,o,c,f,m){this._stateStream=e,this._internalStateOperations=s,this._config=o,this._internalExecutionStrategy=c,this._stateFactory=f,this._selectableStateStream=this._stateStream.pipe((0,Mt.Q)(Vt),Dt(this._internalExecutionStrategy),tt({bufferSize:1,refCount:!0})),this.initStateStream(m)}dispatch(e){return this._internalStateOperations.getRootStateOperations().dispatch(e)}select(e){const s=this.getStoreBoundSelectorFn(e);return this._selectableStateStream.pipe((0,at.U)(s),(0,Ft.K)(o=>{const{suppressErrors:c}=this._config.selectorOptions;return o instanceof TypeError&&c?G(void 0):nt(o)}),function st(t,n=Rt.y){return t=t??Jt,(0,et.e)((e,s)=>{let o,c=!0;e.subscribe((0,Y.x)(s,f=>{const m=n(f);(c||!t(o,m))&&(c=!1,o=m,s.next(f))}))})}(),Dt(this._internalExecutionStrategy))}selectOnce(e){return this.select(e).pipe(Et(1))}selectSnapshot(e){return this.getStoreBoundSelectorFn(e)(this._stateStream.getValue())}subscribe(e){return this._selectableStateStream.pipe(Dt(this._internalExecutionStrategy)).subscribe(e)}snapshot(){return this._internalStateOperations.getRootStateOperations().getState()}reset(e){return this._internalStateOperations.getRootStateOperations().setState(e)}getStoreBoundSelectorFn(e){return function ve(t){const n=function oe(t){return t.NGXS_SELECTOR_META}(t)||ft(t);return n&&n.makeRootSelector||(()=>t)}(e)(this._stateFactory.getRuntimeSelectorContext())}initStateStream(e){const s=this._stateStream.value;if(!s||0===Object.keys(s).length){const f=Object.keys(this._config.defaultsState).length>0?Object.assign({},this._config.defaultsState,e):e;this._stateStream.next(f)}}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(jt),r.LFG(ht),r.LFG(ut),r.LFG(Bt),r.LFG(pt),r.LFG(b,8))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})(),At=(()=>{class t{constructor(e,s){t.store=e,t.config=s}ngOnDestroy(){t.store=null,t.config=null}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(_t),r.LFG(ut))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t.store=null,t.config=null,t})();class me{static get type(){return"@@INIT"}}class He{constructor(n){this.addedStates=n}static get type(){return"@@UPDATE_STATE"}}let We=(()=>{class t{constructor(e,s,o,c,f=[],m){const v=e.addAndReturnDefaults(f);s.setStateToTheCurrentWithNew(v),e.connectActionHandlers(),m.ngxsBootstrap(new me,v)}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(pt),r.LFG(ht),r.LFG(_t),r.LFG(At),r.LFG(X,8),r.LFG(ae))},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({}),t})(),Ke=(()=>{class t{constructor(e,s,o,c=[],f){const m=t.flattenStates(c),v=o.addAndReturnDefaults(m);v.states.length&&(s.setStateToTheCurrentWithNew(v),f.ngxsBootstrap(new He(v.defaults),v))}static flattenStates(e=[]){return e.reduce((s,o)=>s.concat(o),[])}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(_t),r.LFG(ht),r.LFG(pt),r.LFG(Gt,8),r.LFG(ae))},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({}),t})();class z{static forRoot(n=[],e={}){return{ngModule:We,providers:[pt,zt,Le,kt,p,ae,ge,ie,ht,Bt,_t,jt,At,re,...n,...z.ngxsTokenProviders(n,e)]}}static forFeature(n=[]){return{ngModule:Ke,providers:[pt,re,...n,{provide:Gt,multi:!0,useValue:n}]}}static ngxsTokenProviders(n,e){return[{provide:le,useValue:e.executionStrategy},{provide:X,useValue:n},{provide:z.ROOT_OPTIONS,useValue:e},{provide:ut,useFactory:z.ngxsConfigFactory,deps:[z.ROOT_OPTIONS]},{provide:r.tb,useFactory:z.appBootstrapListenerFactory,multi:!0,deps:[p]},{provide:b,useFactory:z.getInitialState},{provide:V,useExisting:zt},{provide:H,useExisting:pt}]}static ngxsConfigFactory(n){return ee(new ut,n)}static appBootstrapListenerFactory(n){return()=>n.bootstrap()}static getInitialState(){return U.pop()}}function Ve(t,n){return(e,s)=>{const o=ne(e.constructor);Array.isArray(t)||(t=[t]);for(const c of t){const f=c.type;o.actions[f]||(o.actions[f]=[]),o.actions[f].push({fn:s,options:n||{},type:f})}}}function Ye(t){return s=>{const o=s,c=ne(o),f=Object.getPrototypeOf(o),m=function n(s){return Object.assign({},s[ue]||{},t)}(f);(function e(s){const{meta:o,inheritedStateClass:c,optionsWithInheritance:f}=s,{children:m,defaults:v,name:x}=f,D="string"==typeof x?x:x&&x.getName()||null;c.hasOwnProperty(Z)&&(o.actions=Object.assign({},o.actions,(c[Z]||{}).actions)),o.children=m,o.defaults=v,o.name=D})({meta:c,inheritedStateClass:f,optionsWithInheritance:m}),o[ue]=m}}function qe(t,...n){return function(e,s){const o=s.toString(),c=`__${o}__selector`,f=function Je(t,n,e=[]){return n=n||function Qe(t){const n=t.length-1;return 36===t.charCodeAt(n)?t.slice(0,n):t}(t),"string"==typeof n?de(e.length?[n,...e]:n.split("."),At.config):n}(o,t,n);Object.defineProperties(e,{[c]:{writable:!0,enumerable:!1,configurable:!0},[o]:{enumerable:!0,configurable:!0,get(){return this[c]||(this[c]=function Ze(t){return At.store||function E(){throw new Error("You have forgotten to import the NGXS module!")}(),At.store.select(t)}(f))}}})}}z.\u0275fac=function(n){return new(n||z)},z.\u0275mod=r.oAB({type:z}),z.\u0275inj=r.cJS({}),z.ROOT_OPTIONS=new r.OlP("ROOT_OPTIONS")},262:($,F,u)=>{u.d(F,{K:()=>O});var r=u(8421),_=u(5403),P=u(4482);function O(M){return(0,P.e)((p,g)=>{let b,y=null,S=!1;y=p.subscribe((0,_.x)(g,void 0,void 0,U=>{b=(0,r.Xf)(M(U,O(M)(p))),y?(y.unsubscribe(),y=null,b.subscribe(g)):S=!0})),S&&(y.unsubscribe(),y=null,b.subscribe(g))})}},9300:($,F,u)=>{u.d(F,{h:()=>P});var r=u(4482),_=u(5403);function P(O,M){return(0,r.e)((p,g)=>{let y=0;p.subscribe((0,_.x)(g,S=>O.call(M,S,y++)&&g.next(S)))})}},8505:($,F,u)=>{u.d(F,{b:()=>M});var r=u(576),_=u(4482),P=u(5403),O=u(4671);function M(p,g,y){const S=(0,r.m)(p)||g||y?{next:p,error:g,complete:y}:p;return S?(0,_.e)((b,U)=>{var V;null===(V=S.subscribe)||void 0===V||V.call(S);let H=!0;b.subscribe((0,P.x)(U,L=>{var A;null===(A=S.next)||void 0===A||A.call(S,L),U.next(L)},()=>{var L;H=!1,null===(L=S.complete)||void 0===L||L.call(S),U.complete()},L=>{var A;H=!1,null===(A=S.error)||void 0===A||A.call(S,L),U.error(L)},()=>{var L,A;H&&(null===(L=S.unsubscribe)||void 0===L||L.call(S)),null===(A=S.finalize)||void 0===A||A.call(S)}))}):O.y}},4408:($,F,u)=>{u.d(F,{o:()=>M});var r=u(727);class _ extends r.w0{constructor(g,y){super()}schedule(g,y=0){return this}}const P={setInterval(p,g,...y){const{delegate:S}=P;return S?.setInterval?S.setInterval(p,g,...y):setInterval(p,g,...y)},clearInterval(p){const{delegate:g}=P;return(g?.clearInterval||clearInterval)(p)},delegate:void 0};var O=u(8737);class M extends _{constructor(g,y){super(g,y),this.scheduler=g,this.work=y,this.pending=!1}schedule(g,y=0){var S;if(this.closed)return this;this.state=g;const b=this.id,U=this.scheduler;return null!=b&&(this.id=this.recycleAsyncId(U,b,y)),this.pending=!0,this.delay=y,this.id=null!==(S=this.id)&&void 0!==S?S:this.requestAsyncId(U,this.id,y),this}requestAsyncId(g,y,S=0){return P.setInterval(g.flush.bind(g,this),S)}recycleAsyncId(g,y,S=0){if(null!=S&&this.delay===S&&!1===this.pending)return y;null!=y&&P.clearInterval(y)}execute(g,y){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const S=this._execute(g,y);if(S)return S;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(g,y){let b,S=!1;try{this.work(g)}catch(U){S=!0,b=U||new Error("Scheduled action threw falsy error")}if(S)return this.unsubscribe(),b}unsubscribe(){if(!this.closed){const{id:g,scheduler:y}=this,{actions:S}=y;this.work=this.state=this.scheduler=null,this.pending=!1,(0,O.P)(S,this),null!=g&&(this.id=this.recycleAsyncId(y,g,null)),this.delay=null,super.unsubscribe()}}}},7565:($,F,u)=>{u.d(F,{v:()=>P});var r=u(6063);class _{constructor(M,p=_.now){this.schedulerActionCtor=M,this.now=p}schedule(M,p=0,g){return new this.schedulerActionCtor(this,M).schedule(g,p)}}_.now=r.l.now;class P extends _{constructor(M,p=_.now){super(M,p),this.actions=[],this._active=!1}flush(M){const{actions:p}=this;if(this._active)return void p.push(M);let g;this._active=!0;do{if(g=M.execute(M.state,M.delay))break}while(M=p.shift());if(this._active=!1,g){for(;M=p.shift();)M.unsubscribe();throw g}}}},6063:($,F,u)=>{u.d(F,{l:()=>r});const r={now:()=>(r.delegate||Date).now(),delegate:void 0}},3268:($,F,u)=>{u.d(F,{Z:()=>O});var r=u(4004);const{isArray:_}=Array;function O(M){return(0,r.U)(p=>function P(M,p){return _(p)?M(...p):M(p)}(M,p))}},1035:($,F,u)=>{u.d(F,{_F:()=>Ot,yz:()=>st,KA:()=>Lt});var r=u(2717),_=u(5980),P=u(515),O=u(8306),M=u(4408);const g=new(u(7565).v)(M.o);var S=u(4482),b=u(5403),V=u(8505),H=u(4004),L=u(9300),A=u(8421),ot=u(5577),T=u(1144),I=u(576),G=u(3268);const W=["addListener","removeListener"],K=["addEventListener","removeEventListener"],Ht=["on","off"];function yt(i,l,a,d){if((0,I.m)(a)&&(d=a,a=void 0),d)return yt(i,l,a).pipe((0,G.Z)(d));const[h,E]=function Y(i){return(0,I.m)(i.addEventListener)&&(0,I.m)(i.removeEventListener)}(i)?K.map(C=>w=>i[C](l,w,a)):function Wt(i){return(0,I.m)(i.addListener)&&(0,I.m)(i.removeListener)}(i)?W.map(Tt(i,l)):function rt(i){return(0,I.m)(i.on)&&(0,I.m)(i.off)}(i)?Ht.map(Tt(i,l)):[];if(!h&&(0,T.z)(i))return(0,ot.z)(C=>yt(C,l,a))((0,A.Xf)(i));if(!h)throw new TypeError("Invalid event target");return new O.y(C=>{const w=(...B)=>C.next(1<B.length?B:B[0]);return h(w),()=>E(w)})}function Tt(i,l){return a=>d=>i[a](l,d)}var Kt=u(7579);const St="GET_STORE",it="STORE_UPATE",Ct="STORE_INIT",nt="ACTION_DISPATCHED",vt=new r.OlP("STATE_FILTER"),It=new r.OlP("BROADCAST_CHANNEL_NAME");class Q{}const mt=new r.OlP("ALLOWED_ORIGIN"),Ot=new r.OlP("KNOWN_ACTION"),Vt=new r.OlP("DEBOUNCE_TIME");function Yt(i){let l;if(Array.isArray(i)){l=[...i];const a=Object.getPrototypeOf(i);if(a!==Array.prototype){Object.setPrototypeOf(l,a);for(const d in i)!/^\d+$/.test(d)&&Object.hasOwn(i,d)&&(l[d]=i[d])}}else l=Object.create(Object.getPrototypeOf(i)),Object.assign(l,i);return l}function*q(i,l,a,d){if("object"==typeof i&&i){if(a.has(i))return;a.add(i)}if("object"!=typeof i||null===i||"object"!=typeof l||null===l)i!==l&&(yield{key:d,operation:"update",value:l});else{for(let h in i){const E=d+h;i[h]!==l[h]&&(!(h in l)||typeof l[h]>"u"||null===l[h]?yield{key:E,operation:"remove"}:typeof i[h]!=typeof l[h]||"object"!=typeof i[h]||"object"!=typeof l[h]||Object.getPrototypeOf(i[h])!==Object.getPrototypeOf(l[h])?yield{key:E,operation:"update",value:l[h]}:i[h]instanceof Date?i[h].getTime()!==l[h].getTime()&&(yield{key:E,operation:"update",value:l[h]}):i[h]instanceof RegExp?i[h].toString()!==l[h].toString()&&(yield{key:E,operation:"update",value:l[h]}):yield*q(i[h],l[h],a,`${d}${h}.`))}for(let h in l){const E=d+h;!(h in i)&&typeof l[h]<"u"&&null!==l[h]&&(yield{key:E,operation:"add",value:l[h]})}}}function at(i,l){return q(i,l,new WeakSet,"")}let tt=(()=>{class i{constructor(a){this.payload=a}}return i.type="@@MESSAGE",i})(),et=(()=>{class i{constructor(a){this.payload=a}}return i.type="@@INIT_MESSAGE",i})(),Et=(()=>{class i{constructor(a,d){this.commsService=a,this.store=d,this.init=()=>{this.subscription&&(console.warn("ChildHandler is already initiated, will re-initiate"),this.subscription.unsubscribe()),this.subscription=this.commsService.messages$.subscribe(h=>{h.type===it?this.store.dispatch(new tt(h.payload)):h.type===Ct&&this.store.dispatch(new et(h.payload))}),this.commsService.postMessage({type:St})}}ngOnDestroy(){this.subscription?.unsubscribe()}}return i.\u0275fac=function(a){return new(a||i)(r.LFG(Q),r.LFG(_.yh))},i.\u0275prov=r.Yz7({token:i,factory:i.\u0275fac}),i})(),xt=(()=>{class i{constructor(a){this.commsService=a}handle(a,d,h){if(d instanceof _.XP)return h(a,d);if(d instanceof tt){if(d.payload.length>0){const E=function Xt(i,l){let a=Yt(i);for(let d of l){const h=d.key.split(".");let E=a;for(let w of h.slice(0,-1)){if("object"!=typeof E[w]||null===E[w])throw console.error("Invalid diff key",d.key,"does not exist in state",i,"Navigated to",E),new Error(`Invalid diff key ${d.key} does not exist in state`);E=E[w]=Yt(E[w])}let C=h.at(-1);switch(d.operation){case"add":case"update":E[C]=d.value;break;case"remove":delete E[C]}}return a}(a,d.payload);return h(E,d)}}else{if(d instanceof et)return h(d.payload,d);this.commsService.postMessage({type:nt,actionType:d.constructor?.type,action:d})}return P.E}}return i.\u0275fac=function(a){return new(a||i)(r.LFG(Q))},i.\u0275prov=r.Yz7({token:i,factory:i.\u0275fac}),i})(),ct=(()=>{class i{constructor(a,d,h,E,C){this.store=a,this.commsService=d,this.stateFilter=h,this.debounce=C,this.subscriptions=[],this.init=()=>{if(this.subscriptions.length)for(console.warn("HostHandler is already initiated, will re-initiate");this.subscriptions.length;)this.subscriptions.pop()?.unsubscribe();let w;this.subscriptions.push(this.commsService.messages$.subscribe(R=>{switch(R.type){case nt:this.onActionDispatched(R.actionType,R.action);break;case St:this.onGetStore()}}));const B=new O.y(R=>{const X=this.store.subscribe(Gt=>{R.next(Gt)});return()=>X.unsubscribe()});this.subscriptions.push(B.pipe(this.debounce?function U(i,l=g){return(0,S.e)((a,d)=>{let h=null,E=null,C=null;const w=()=>{if(h){h.unsubscribe(),h=null;const R=E;E=null,d.next(R)}};function B(){const R=C+i,X=l.now();if(X<R)return h=this.schedule(void 0,R-X),void d.add(h);w()}a.subscribe((0,b.x)(d,R=>{E=R,C=l.now(),h||(h=l.schedule(B,i),d.add(h))},()=>{w(),d.complete()},void 0,()=>{E=h=null}))})}(this.debounce):(0,V.b)(()=>{}),(0,H.U)(R=>this.filterState(R)),(0,H.U)(R=>{const X=Array.from(at(w,R));return w=R,X}),(0,L.h)(R=>R.length>0)).subscribe(R=>{this.commsService.postMessage({type:it,payload:R})}))},this.debounce??(this.debounce=100),this.knownActions=new Map(E?.flat().map(w=>[w.type,w]))}filterState(a){if("function"==typeof this.stateFilter)return this.stateFilter(a);if(this.stateFilter instanceof RegExp){const d=this.stateFilter;return Object.fromEntries(Object.entries(a).filter(([h])=>d.test(h)))}return a}onGetStore(){this.commsService.postMessage({type:Ct,payload:this.filterState(this.store.snapshot())})}onActionDispatched(a,d){var h;if(a){const E=this.knownActions.get(a),C=E?Object.create(E.prototype):new((h=class{}).type=a,h);this.store.dispatch(Object.assign(C,d))}else this.store.dispatch(d)}ngOnDestroy(){for(const a of this.subscriptions)a.unsubscribe()}}return i.\u0275fac=function(a){return new(a||i)(r.LFG(_.yh),r.LFG(Q),r.LFG(vt,8),r.LFG(Ot,8),r.LFG(Vt,8))},i.\u0275prov=r.Yz7({token:i,factory:i.\u0275fac}),i})();function Nt(i){if("string"==typeof i?.data?.type){switch(i.data.type){case nt:case St:case it:break;default:console.warn("Unknown message type.",i.data)}return!0}return console.warn("Invalid message event",i),!1}let Zt=(()=>{class i{constructor(a){this.channel=new BroadcastChannel(a),this.messages$=yt(this.channel,"message").pipe((0,L.h)(Nt),(0,H.U)(d=>d.data))}postMessage(a){this.channel.postMessage(a)}}return i.\u0275fac=function(a){return new(a||i)(r.LFG(It))},i.\u0275prov=r.Yz7({token:i,factory:i.\u0275fac}),i})();const Mt="PORT_SETUP",Rt="PORT_TEARDOWN";let st=(()=>{class i{constructor(){this.$messages=new Kt.x,this.ports=new Map,this.messages$=this.$messages.asObservable(),this.eventSourcesChanged=new r.vpe,this.handleMessage=a=>{if(a.data===Rt){const d=a.source??a.target;d&&(this.ports.delete(d),d.removeEventListener("message",this.handleMessage),d.close())}else Nt(a)&&this.$messages.next(a.data)},window.addEventListener("unload",()=>this.ngOnDestroy(!1))}get eventSources(){return this.ports.values()}addPort(a,d){this.ports.set(a,d),this.eventSourcesChanged.emit(),a.addEventListener("message",this.handleMessage),a.start()}removePort(a,d=!0){a.postMessage(Rt),a.removeEventListener("message",this.handleMessage),a.close(),d&&(this.ports.delete(a),this.eventSourcesChanged.emit())}ngOnDestroy(a=!0){for(const d of this.ports.keys())this.removePort(d,!1);a&&this.ports.clear(),this.$messages.complete()}postMessage(a){for(const d of this.ports.keys())d.postMessage(a)}}return i.\u0275fac=function(a){return new(a||i)},i.\u0275prov=r.Yz7({token:i,factory:i.\u0275fac}),i})(),Jt=(()=>{class i extends st{constructor(a){super(),a??(a=location.origin);const d=new MessageChannel;if(window.opener)this.addPort(d.port1,window.opener),window.opener.postMessage(Mt,a,[d.port2]);else{if(window.parent===window)throw new Error("Unable to connect to store host");this.addPort(d.port1,window.parent),window.parent.postMessage(Mt,a,[d.port2])}}}return i.\u0275fac=function(a){return new(a||i)(r.LFG(mt,8))},i.\u0275prov=r.Yz7({token:i,factory:i.\u0275fac}),i})(),Qt=(()=>{class i extends st{constructor(a){super(),a??(a=location.origin);const d=new Set("string"==typeof a?[a]:a.flat());window.addEventListener("message",h=>{!d.has("*")&&!d.has(h.origin)||h.data===Mt&&this.addPort(h.ports[0],h.source)})}}return i.\u0275fac=function(a){return new(a||i)(r.LFG(mt,8))},i.\u0275prov=r.Yz7({token:i,factory:i.\u0275fac}),i})();function bt(i,l){const a=[];return i?(a.push(ct),l?.filter&&a.push({provide:vt,useValue:l.filter})):a.push(Et,{provide:_.fN,useClass:xt,multi:!0}),l?.knownActions instanceof Array&&a.push({provide:Ot,useValue:l.knownActions,multi:!0}),"broadcast"===l?.messageHandler?a.push({provide:Q,useClass:Zt},{provide:It,useValue:l.broadcastChannelName??"NGXS Messages"}):typeof l?.messageHandler>"u"||"port"===l.messageHandler?(a.push({provide:st,useClass:i?Qt:Jt},{provide:Q,useExisting:st}),l?.origin&&a.push({provide:mt,useValue:l.origin})):a.push({provide:Q,useExisting:l.messageHandler}),{ngModule:Lt,providers:a}}let Lt=(()=>{class i{constructor(a,d){a?.init()??d?.init()}static forChild(a){return bt(!1,a)}static forRoot(a){return bt(!0,a)}}return i.\u0275fac=function(a){return new(a||i)(r.LFG(ct,8),r.LFG(Et,8))},i.\u0275mod=r.oAB({type:i}),i.\u0275inj=r.cJS({}),i})()}}]);