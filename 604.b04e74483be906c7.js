"use strict";(self.webpackChunktestapp=self.webpackChunktestapp||[]).push([[604],{3657:(z,w,u)=>{u.d(w,{R:()=>p});var r=u(655),_=u(5980),F=u(2011),O=u(2717),M=u(6895);class p{constructor(y){this.store=y}increment(){this.store.dispatch(new F.MP)}decrement(){this.store.dispatch(new F.FB)}}p.\u0275fac=function(y){return new(y||p)(O.Y36(_.yh))},p.\u0275cmp=O.Xpm({type:p,selectors:[["app-counter"]],decls:7,vars:3,consts:[[3,"click"]],template:function(y,S){1&y&&(O.TgZ(0,"p"),O._uU(1),O.ALo(2,"async"),O.qZA(),O.TgZ(3,"button",0),O.NdJ("click",function(){return S.increment()}),O._uU(4,"Increment"),O.qZA(),O.TgZ(5,"button",0),O.NdJ("click",function(){return S.decrement()}),O._uU(6,"Decrement"),O.qZA()),2&y&&(O.xp6(1),O.hij("counter works! the count is ",O.lcZ(2,1,S.count$),""))},dependencies:[M.Ov]}),(0,r.gn)([(0,_.Ph)(F.uT)],p.prototype,"count$",void 0)},7848:(z,w,u)=>{u.d(w,{k:()=>M});var r=u(6895),_=u(1035),F=u(2011),O=u(2717);let M=(()=>{class p{}return p.\u0275fac=function(y){return new(y||p)},p.\u0275mod=O.oAB({type:p}),p.\u0275inj=O.cJS({providers:[{provide:_._F,useValue:[F.MP,F.FB],multi:!0}],imports:[r.ez]}),p})()},2011:(z,w,u)=>{u.d(w,{FB:()=>M,MP:()=>O,uT:()=>p});var r=u(655),_=u(5980),F=u(2717);let O=(()=>{class g{}return g.type="[Counter] Increment",g})(),M=(()=>{class g{}return g.type="[Counter] Decrement",g})(),p=class{change(y,S){S instanceof O?y.setState(y.getState()+1):S instanceof M&&y.setState(y.getState()-1)}};p.\u0275fac=function(y){return new(y||p)},p.\u0275prov=F.Yz7({token:p,factory:p.\u0275fac}),(0,r.gn)([(0,_.aU)([O,M])],p.prototype,"change",null),p=(0,r.gn)([(0,_.ZM)({name:"counter",defaults:0})],p)},2689:(z,w,u)=>{u.d(w,{ns:()=>L});var r=u(2717),_=u(5980),F=u(262),O=u(8505);const y=new r.OlP("NGXS_DEVTOOLS_OPTIONS");let U=(()=>{class A{constructor(T,x,G){this._options=T,this._injector=x,this._ngZone=G,this.devtoolsExtension=null,this.globalDevtools=r.dqk.__REDUX_DEVTOOLS_EXTENSION__||r.dqk.devToolsExtension,this.unsubscribe=null,this.connect()}ngOnDestroy(){null!==this.unsubscribe&&this.unsubscribe(),this.globalDevtools&&this.globalDevtools.disconnect()}get store(){return this._injector.get(_.yh)}handle(T,x,G){return!this.devtoolsExtension||this._options.disabled?G(T,x):G(T,x).pipe((0,F.K)(H=>{const W=this.store.snapshot();throw this.sendToDevTools(T,x,W),H}),(0,O.b)(H=>{this.sendToDevTools(T,x,H)}))}sendToDevTools(T,x,G){const H=(0,_.f4)(x);"@@INIT"===H?this.devtoolsExtension.init(T):this.devtoolsExtension.send(Object.assign({},x,{action:null,type:H}),G)}dispatched(T){if("DISPATCH"===T.type){if("JUMP_TO_ACTION"===T.payload.type||"JUMP_TO_STATE"===T.payload.type){const x=JSON.parse(T.state);x.router&&x.router.trigger&&(x.router.trigger="devtools"),this.store.reset(x)}else if("TOGGLE_ACTION"===T.payload.type)console.warn("Skip is not supported at this time.");else if("IMPORT_STATE"===T.payload.type){const{actionsById:x,computedStates:G,currentStateIndex:H}=T.payload.nextLiftedState;this.devtoolsExtension.init(G[0].state),Object.keys(x).filter(W=>"0"!==W).forEach(W=>this.devtoolsExtension.send(x[W],G[W].state)),this.store.reset(G[H].state)}}else if("ACTION"===T.type){const x=JSON.parse(T.payload);this.store.dispatch(x)}}connect(){!this.globalDevtools||this._options.disabled||(this.devtoolsExtension=this._ngZone.runOutsideAngular(()=>this.globalDevtools.connect(this._options)),this.unsubscribe=this.devtoolsExtension.subscribe(T=>{("DISPATCH"===T.type||"ACTION"===T.type)&&this._ngZone.run(()=>{this.dispatched(T)})}))}}return A.\u0275fac=function(T){return new(T||A)(r.LFG(y),r.LFG(r.zs3),r.LFG(r.R0b))},A.\u0275prov=r.Yz7({token:A,factory:A.\u0275fac}),A})();function K(A){return Object.assign({name:"NGXS"},A)}const $=new r.OlP("USER_OPTIONS");let L=(()=>{class A{static forRoot(T){return{ngModule:A,providers:[{provide:_.fN,useClass:U,multi:!0},{provide:$,useValue:T},{provide:y,useFactory:K,deps:[$]}]}}}return A.\u0275fac=function(T){return new(T||A)},A.\u0275mod=r.oAB({type:A}),A.\u0275inj=r.cJS({}),A})()},5980:(z,w,u)=>{u.d(w,{aU:()=>Ve,XP:()=>me,fN:()=>Gt,$l:()=>j,Ph:()=>qe,ZM:()=>Ye,yh:()=>Tt,f4:()=>ut});var r=u(2717),_=u(7579),F=u(6063);class O extends _.x{constructor(n=1/0,e=1/0,s=F.l){super(),this._bufferSize=n,this._windowTime=e,this._timestampProvider=s,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,n),this._windowTime=Math.max(1,e)}next(n){const{isStopped:e,_buffer:s,_infiniteTimeWindow:o,_timestampProvider:c,_windowTime:f}=this;e||(s.push(n),!o&&s.push(c.now()+f)),this._trimBuffer(),super.next(n)}_subscribe(n){this._throwIfClosed(),this._trimBuffer();const e=this._innerSubscribe(n),{_infiniteTimeWindow:s,_buffer:o}=this,c=o.slice();for(let f=0;f<c.length&&!n.closed;f+=s?1:2)n.next(c[f]);return this._checkFinalizedStatuses(n),e}_trimBuffer(){const{_bufferSize:n,_timestampProvider:e,_buffer:s,_infiniteTimeWindow:o}=this,c=(o?1:2)*n;if(n<1/0&&c<s.length&&s.splice(0,s.length-c),!o){const f=e.now();let m=0;for(let v=1;v<s.length&&s[v]<=f;v+=2)m=v;m&&s.splice(0,m+1)}}}let p=(()=>{class t{constructor(){this.bootstrap$=new O(1)}get appBootstrapped$(){return this.bootstrap$.asObservable()}bootstrap(){this.bootstrap$.next(!0),this.bootstrap$.complete()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})();function g(t,n){return t===n}function y(t,n,e){if(null===n||null===e||n.length!==e.length)return!1;const s=n.length;for(let o=0;o<s;o++)if(!t(n[o],e[o]))return!1;return!0}const b=new r.OlP("INITIAL_STATE_TOKEN");let U=(()=>{class t{static set(e){this.value=e}static pop(){const e=this.value;return this.value={},e}}return t.value={},t})();const K=new r.OlP("Internals.StateContextFactory"),$=new r.OlP("Internals.StateFactory");var L=u(6895),A=u(8306);class rt extends _.x{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const e=super._subscribe(n);return!e.closed&&n.next(this._value),e}getValue(){const{hasError:n,thrownError:e,_value:s}=this;if(n)throw e;return this._throwIfClosed(),s}next(n){super.next(this._value=n)}}var T=u(7669),x=u(457);function G(...t){const n=(0,T.yG)(t);return(0,x.D)(t,n)}const{isArray:H}=Array,{getPrototypeOf:W,prototype:Ht,keys:gt}=Object;var it=u(8421),V=u(5403),Kt=u(3268);function yt(t,n){return t.reduce((e,s,o)=>(e[s]=n[o],e),{})}function at(...t){const n=(0,T.jO)(t),{args:e,keys:s}=function It(t){if(1===t.length){const n=t[0];if(H(n))return{args:n,keys:null};if(function Wt(t){return t&&"object"==typeof t&&W(t)===Ht}(n)){const e=gt(n);return{args:e.map(s=>n[s]),keys:e}}}return{args:t,keys:null}}(t),o=new A.y(c=>{const{length:f}=e;if(!f)return void c.complete();const m=new Array(f);let v=f,P=f;for(let D=0;D<f;D++){let R=!1;(0,it.Xf)(e[D]).subscribe((0,V.x)(c,B=>{R||(R=!0,P--),m[D]=B},()=>v--,void 0,()=>{(!v||!R)&&(P||c.next(s?yt(s,m):m),c.complete())}))}});return n?o.pipe((0,Kt.Z)(n)):o}var xt=u(576);function tt(t,n){const e=(0,xt.m)(t)?t:()=>t,s=o=>o.error(e());return new A.y(n?o=>n.schedule(s,0,o):s)}var St=u(515),Pt=u(4408),vt=u(7565);const Vt=new class mt extends vt.v{}(class J extends Pt.o{constructor(n,e){super(n,e),this.scheduler=n,this.work=e}schedule(n,e=0){return e>0?super.schedule(n,e):(this.delay=e,this.state=n,this.scheduler.flush(this),this)}execute(n,e){return e>0||this.closed?super.execute(n,e):this._execute(n,e)}requestAsyncId(n,e,s=0){return null!=s&&s>0||null==s&&this.delay>0?super.requestAsyncId(n,e,s):(n.flush(this),0)}});var et=u(9300),nt=u(4004),Xt=u(3099);function st(t,n,e){let s,o=!1;return t&&"object"==typeof t?({bufferSize:s=1/0,windowTime:n=1/0,refCount:o=!1,scheduler:e}=t):s=t??1/0,(0,Xt.B)({connector:()=>new O(s,n,e),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:o})}var Q=u(4482);function Ot(t){return t<=0?()=>St.E:(0,Q.e)((n,e)=>{let s=0;n.subscribe((0,V.x)(e,o=>{++s<=t&&(e.next(o),t<=s&&e.complete())}))})}function Et(t,n){return n?e=>e.pipe(Et((s,o)=>(0,it.Xf)(t(s,o)).pipe((0,nt.U)((c,f)=>n(s,c,o,f))))):(0,Q.e)((e,s)=>{let o=0,c=null,f=!1;e.subscribe((0,V.x)(s,m=>{c||(c=(0,V.x)(s,void 0,()=>{c=null,f&&s.complete()}),(0,it.Xf)(t(m,o++)).subscribe(c))},()=>{f=!0,!c&&s.complete()}))})}var Mt=u(5577);function Dt(t){return(0,Q.e)((n,e)=>{let s=!1;n.subscribe((0,V.x)(e,o=>{s=!0,e.next(o)},()=>{s||e.next(t),e.complete()}))})}var Ft=u(262),Zt=u(5032);function wt(t){return(0,Q.e)((n,e)=>{(0,it.Xf)(t).subscribe((0,V.x)(e,()=>e.complete(),Zt.Z)),!e.closed&&n.subscribe(e)})}var Nt=u(8505),Jt=u(5363),_t=u(4671);function ot(t,n){return t===n}class C{constructor(n,e){this._ngZone=n,this._platformId=e}enter(n){return(0,L.PM)(this._platformId)?this.runInsideAngular(n):this.runOutsideAngular(n)}leave(n){return this.runInsideAngular(n)}runInsideAngular(n){return r.R0b.isInAngularZone()?n():this._ngZone.run(n)}runOutsideAngular(n){return r.R0b.isInAngularZone()?this._ngZone.runOutsideAngular(n):n()}}C.\u0275fac=function(n){return new(n||C)(r.LFG(r.R0b),r.LFG(r.Lbi))},C.\u0275prov=r.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"}),C.ngInjectableDef=(0,r.Ez6)({factory:function(){return new C((0,r.f3M)(r.R0b),(0,r.f3M)(r.Lbi))},token:C,providedIn:"root"});const N=new r.OlP("ROOT_STATE_TOKEN"),Y=new r.OlP("FEATURE_STATE_TOKEN"),Gt=new r.OlP("NGXS_PLUGINS"),X="NGXS_META",ue="NGXS_OPTIONS_META";let ct=(()=>{class t{constructor(){this.defaultsState={},this.selectorOptions={injectContainerState:!0,suppressErrors:!0},this.compatibility={strictContentSecurityPolicy:!1},this.executionStrategy=C}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})();class Oe{constructor(n,e,s){this.previousValue=n,this.currentValue=e,this.firstChange=s}}class Z{enter(n){return n()}leave(n){return n()}}Z.\u0275fac=function(n){return new(n||Z)},Z.\u0275prov=r.Yz7({token:Z,factory:Z.\u0275fac,providedIn:"root"}),Z.ngInjectableDef=(0,r.Ez6)({factory:function(){return new Z},token:Z,providedIn:"root"});const le=new r.OlP("USER_PROVIDED_NGXS_EXECUTION_STRATEGY"),Ee=new r.OlP("NGXS_EXECUTION_STRATEGY",{providedIn:"root",factory:()=>{const t=(0,r.f3M)(r.gxx),n=t.get(le);return t.get(n||(typeof r.dqk.Zone<"u"?C:Z))}});function ut(t){return t.constructor&&t.constructor.type?t.constructor.type:t.type}const fe=(t,n,e)=>{t=Object.assign({},t);const s=n.split("."),o=s.length-1;return s.reduce((c,f,m)=>(c[f]=m===o?e:Array.isArray(c[f])?c[f].slice():Object.assign({},c[f]),c&&c[f]),t),t},Ut=(t,n)=>n.split(".").reduce((e,s)=>e&&e[s],t),ee=t=>t&&"object"==typeof t&&!Array.isArray(t),ne=(t,...n)=>{if(!n.length)return t;const e=n.shift();if(ee(t)&&ee(e))for(const s in e)ee(e[s])?(t[s]||Object.assign(t,{[s]:{}}),ne(t[s],e[s])):Object.assign(t,{[s]:e[s]});return ne(t,...n)};function se(t){if(!t.hasOwnProperty(X)){const n={name:null,actions:{},defaults:{},path:null,makeRootSelector:e=>e.getStateGetter(n.name),children:[]};Object.defineProperty(t,X,{value:n})}return lt(t)}function lt(t){return t[X]}function de(t,n){return n&&n.compatibility&&n.compatibility.strictContentSecurityPolicy?function Me(t){const n=t.slice();return e=>n.reduce((s,o)=>s&&s[o],e)}(t):function De(t){const n=t;let e="store."+n[0],s=0;const o=n.length;let c=e;for(;++s<o;)c=c+" && "+(e=e+"."+n[s]);return new Function("store","return "+c+";")}(t)}function he(t,n){const e=Ut(n.currentAppState,t.path),s=Ut(n.newAppState,t.path);return new Oe(e,s,!t.isInitialised)}function xe(...t){return function ft(t,n,e=we){const s=function Ne(t){return t.reduce((n,e)=>(n[ut(e)]=!0,n),{})}(t),o=n&&function Re(t){return t.reduce((n,e)=>(n[e]=!0,n),{})}(n);return function(c){return c.pipe(function Pe(t,n){return(0,et.h)(e=>{const s=ut(e.action);return t[s]&&(!n||n[e.status])})}(s,o),e())}}(t,["DISPATCHED"])}function we(){return(0,nt.U)(t=>t.action)}function At(t){return n=>new A.y(e=>n.subscribe({next(s){t.leave(()=>e.next(s))},error(s){t.leave(()=>e.error(s))},complete(){t.leave(()=>e.complete())}}))}let Bt=(()=>{class t{constructor(e){this._executionStrategy=e}enter(e){return this._executionStrategy.enter(e)}leave(e){return this._executionStrategy.leave(e)}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(Ee))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})();class be extends _.x{constructor(){super(...arguments),this._itemQueue=[],this._busyPushingNext=!1}next(n){if(this._busyPushingNext)this._itemQueue.unshift(n);else{for(this._busyPushingNext=!0,super.next(n);this._itemQueue.length>0;){const e=this._itemQueue.pop();super.next(e)}this._busyPushingNext=!1}}}let kt=(()=>{class t extends be{}return t.\u0275fac=function(){let n;return function(s){return(n||(n=r.n5z(t)))(s||t)}}(),t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})(),Le=(()=>{class t extends A.y{constructor(e,s){super(o=>{const c=e.pipe(At(s)).subscribe({next:f=>o.next(f),error:f=>o.error(f),complete:()=>o.complete()});o.add(c)})}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(kt),r.LFG(Bt))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})();const pe=t=>(...n)=>t.shift()(...n,(...s)=>pe(t)(...s));let jt=(()=>{class t extends rt{constructor(){super({})}ngOnDestroy(){this.complete()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})(),ie=(()=>{class t{constructor(e,s){this._parentManager=e,this._pluginHandlers=s,this.plugins=[],this.registerHandlers()}get rootPlugins(){return this._parentManager&&this._parentManager.plugins||this.plugins}registerHandlers(){const e=this.getPluginHandlers();this.rootPlugins.push(...e)}getPluginHandlers(){return(this._pluginHandlers||[]).map(s=>s.handle?s.handle.bind(s):s)}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(t,12),r.LFG(Gt,8))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})(),ae=(()=>{class t extends _.x{}return t.\u0275fac=function(){let n;return function(s){return(n||(n=r.n5z(t)))(s||t)}}(),t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})(),ge=(()=>{class t{constructor(e,s,o,c,f,m){this._injector=e,this._actions=s,this._actionResults=o,this._pluginManager=c,this._stateStream=f,this._ngxsExecutionStrategy=m}dispatch(e){const s=this._ngxsExecutionStrategy.enter(()=>this.dispatchByEvents(e));return s.subscribe({error:o=>this._ngxsExecutionStrategy.leave(()=>{try{this._errorHandler=this._errorHandler||this._injector.get(r.qLn),this._errorHandler.handleError(o)}catch{}})}),s.pipe(At(this._ngxsExecutionStrategy))}dispatchByEvents(e){return Array.isArray(e)?0===e.length?G(this._stateStream.getValue()):at(e.map(s=>this.dispatchSingle(s))):this.dispatchSingle(e)}dispatchSingle(e){const s=this._stateStream.getValue();return pe([...this._pluginManager.plugins,(c,f)=>{c!==s&&this._stateStream.next(c);const m=this.getActionResultStream(f);return m.subscribe(v=>this._actions.next(v)),this._actions.next({action:f,status:"DISPATCHED"}),this.createDispatchObservable(m)}])(s,e).pipe(st())}getActionResultStream(e){return this._actionResults.pipe((0,et.h)(s=>s.action===e&&"DISPATCHED"!==s.status),Ot(1),st())}createDispatchObservable(e){return e.pipe(Et(s=>{switch(s.status){case"SUCCESSFUL":return G(this._stateStream.getValue());case"ERRORED":return tt(s.error);default:return St.E}})).pipe(st())}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(r.zs3),r.LFG(kt),r.LFG(ae),r.LFG(ie),r.LFG(jt),r.LFG(Bt))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})(),dt=(()=>{class t{constructor(e,s,o){this._stateStream=e,this._dispatcher=s,this._config=o}getRootStateOperations(){return{getState:()=>this._stateStream.getValue(),setState:s=>this._stateStream.next(s),dispatch:s=>this._dispatcher.dispatch(s)}}setStateToTheCurrentWithNew(e){const s=this.getRootStateOperations(),o=s.getState();s.setState(Object.assign({},o,e.defaults))}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(jt),r.LFG(ge),r.LFG(ct))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})();let zt=(()=>{class t{constructor(e){this._internalStateOperations=e}createStateContext(e){const s=this._internalStateOperations.getRootStateOperations();function o(v){return Ut(v,e.path)}function c(v,P){const D=fe(v,e.path,P),R=e.instance;if(R.ngxsOnChanges){const B=he(e,{currentAppState:v,newAppState:D});R.ngxsOnChanges(B)}return s.setState(D),D}function f(v,P){return c(v,P(o(v)))}return{getState:()=>o(s.getState()),patchState:v=>f(s.getState(),function Ge(t){return n=>{Array.isArray(t)?function E(){throw new Error("Patching arrays is not supported.")}():"object"!=typeof t&&function I(){throw new Error("Patching primitives is not supported.")}();const e=Object.assign({},n);for(const s in t)e[s]=t[s];return e}}(v)),setState(v){const P=s.getState();return function m(v){return"function"==typeof v}(v)?f(P,v):c(P,v)},dispatch:v=>s.dispatch(v)}}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(dt))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})();new RegExp("^[a-zA-Z0-9_]+$");let ht=(()=>{class t{constructor(e,s,o,c,f,m,v){this._injector=e,this._config=s,this._parentFactory=o,this._actions=c,this._actionResults=f,this._stateContextFactory=m,this._initialState=v,this._actionsSubscription=null,this._states=[],this._statesByName={},this._statePaths={},this.getRuntimeSelectorContext=function S(t,n=g){let e=null,s=null;function o(){return y(n,e,arguments)||(s=t.apply(null,arguments)),e=arguments,s}return o.reset=function(){e=null,s=null},o}(()=>{const P=this;function D(B){const k=P.statePaths[B];return k?de(k.split("."),P._config):null}return this._parentFactory?this._parentFactory.getRuntimeSelectorContext():{getStateGetter(B){let k=D(B);return k||((...pt)=>(k||(k=D(B)),k?k(...pt):void 0))},getSelectorOptions:B=>Object.assign({},P._config.selectorOptions,B||{})}})}get states(){return this._parentFactory?this._parentFactory.states:this._states}get statesByName(){return this._parentFactory?this._parentFactory.statesByName:this._statesByName}get statePaths(){return this._parentFactory?this._parentFactory.statePaths:this._statePaths}static cloneDefaults(e){let s={};return s=Array.isArray(e)?e.slice():function Ie(t){return"object"==typeof t&&null!==t||"function"==typeof t}(e)?Object.assign({},e):void 0===e?{}:e,s}ngOnDestroy(){this._actionsSubscription.unsubscribe()}add(e){const{newStates:s}=this.addToStatesMap(e);if(!s.length)return[];const o=function _e(t){const n=e=>t.find(o=>o===e)[X].name;return t.reduce((e,s)=>{const{name:o,children:c}=s[X];return e[o]=(c||[]).map(n),e},{})}(s),c=function Ce(t){const n=[],e={},s=(o,c=[])=>{Array.isArray(c)||(c=[]),c.push(o),e[o]=!0,t[o].forEach(f=>{e[f]||s(f,c.slice(0))}),n.indexOf(o)<0&&n.push(o)};return Object.keys(t).forEach(o=>s(o)),n.reverse()}(o),f=function Te(t,n={}){const e=(s,o)=>{for(const c in s)if(s.hasOwnProperty(c)&&s[c].indexOf(o)>=0){const f=e(s,c);return null!==f?`${f}.${c}`:c}return null};for(const s in t)if(t.hasOwnProperty(s)){const o=e(t,s);n[s]=o?`${o}.${s}`:s}return n}(o),m=function Ae(t){return t.reduce((n,e)=>(n[e[X].name]=e,n),{})}(s),v=[];for(const P of c){const D=m[P],R=f[P],B=D[X];this.addRuntimeInfoToMeta(B,R);const k={name:P,path:R,isInitialised:!1,actions:B.actions,instance:this._injector.get(D),defaults:t.cloneDefaults(B.defaults)};this.hasBeenMountedAndBootstrapped(P,R)||v.push(k),this.states.push(k)}return v}addAndReturnDefaults(e){const o=this.add(e||[]);return{defaults:o.reduce((f,m)=>fe(f,m.path,m.defaults),{}),states:o}}connectActionHandlers(){if(null!==this._actionsSubscription)return;const e=new _.x;this._actionsSubscription=this._actions.pipe((0,et.h)(s=>"DISPATCHED"===s.status),(0,Mt.z)(s=>{e.next(s);const o=s.action;return this.invokeActions(e,o).pipe((0,nt.U)(()=>({action:o,status:"SUCCESSFUL"})),Dt({action:o,status:"CANCELED"}),(0,Ft.K)(c=>G({action:o,status:"ERRORED",error:c})))})).subscribe(s=>this._actionResults.next(s))}invokeActions(e,s){const o=ut(s),c=[];for(const f of this.states){const m=f.actions[o];if(m)for(const v of m){const P=this._stateContextFactory.createStateContext(f);try{let D=f.instance[v.fn](P,s);D instanceof Promise&&(D=(0,x.D)(D)),D instanceof A.y?(D=D.pipe((0,Mt.z)(R=>R instanceof Promise?(0,x.D)(R):R instanceof A.y?R:G(R)),Dt({})),v.options.cancelUncompleted&&(D=D.pipe(wt(e.pipe(xe(s)))))):D=G({}).pipe(st()),c.push(D)}catch(D){c.push(tt(D))}}}return c.length||c.push(G({})),at(c)}addToStatesMap(e){const s=[],o=this.statesByName;for(const c of e){const f=lt(c).name;!o[f]&&(s.push(c),o[f]=c)}return{newStates:s}}addRuntimeInfoToMeta(e,s){this.statePaths[e.name]=s,e.path=s}hasBeenMountedAndBootstrapped(e,s){const o=void 0!==Ut(this._initialState,s);return this.statesByName[e]&&o}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(r.zs3),r.LFG(ct),r.LFG(t,12),r.LFG(kt),r.LFG(ae),r.LFG(zt),r.LFG(b,8))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})(),ce=(()=>{class t{constructor(e,s,o){this.internalStateOperations=e,this.stateContextFactory=s,this.bootstrapper=o}ngxsBootstrap(e,s){this.internalStateOperations.getRootStateOperations().dispatch(e).pipe((0,et.h)(()=>!!s),(0,Nt.b)(()=>this.invokeInit(s.states)),(0,Mt.z)(()=>this.bootstrapper.appBootstrapped$),(0,et.h)(o=>!!o)).subscribe(()=>this.invokeBootstrap(s.states))}invokeInit(e){for(const s of e){const o=s.instance;if(o.ngxsOnChanges){const m=he(s,{currentAppState:{},newAppState:this.internalStateOperations.getRootStateOperations().getState()});o.ngxsOnChanges(m)}o.ngxsOnInit&&o.ngxsOnInit(this.getStateContext(s)),s.isInitialised=!0}}invokeBootstrap(e){for(const s of e){const o=s.instance;o.ngxsAfterBootstrap&&o.ngxsAfterBootstrap(this.getStateContext(s))}}getStateContext(e){return this.stateContextFactory.createStateContext(e)}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(dt),r.LFG(zt),r.LFG(p))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})();let Tt=(()=>{class t{constructor(e,s,o,c,f,m){this._stateStream=e,this._internalStateOperations=s,this._config=o,this._internalExecutionStrategy=c,this._stateFactory=f,this._selectableStateStream=this._stateStream.pipe((0,Jt.Q)(Vt),At(this._internalExecutionStrategy),st({bufferSize:1,refCount:!0})),this.initStateStream(m)}dispatch(e){return this._internalStateOperations.getRootStateOperations().dispatch(e)}select(e){const s=this.getStoreBoundSelectorFn(e);return this._selectableStateStream.pipe((0,nt.U)(s),(0,Ft.K)(o=>{const{suppressErrors:c}=this._config.selectorOptions;return o instanceof TypeError&&c?G(void 0):tt(o)}),function Rt(t,n=_t.y){return t=t??ot,(0,Q.e)((e,s)=>{let o,c=!0;e.subscribe((0,V.x)(s,f=>{const m=n(f);(c||!t(o,m))&&(c=!1,o=m,s.next(f))}))})}(),At(this._internalExecutionStrategy))}selectOnce(e){return this.select(e).pipe(Ot(1))}selectSnapshot(e){return this.getStoreBoundSelectorFn(e)(this._stateStream.getValue())}subscribe(e){return this._selectableStateStream.pipe(At(this._internalExecutionStrategy)).subscribe(e)}snapshot(){return this._internalStateOperations.getRootStateOperations().getState()}reset(e){return this._internalStateOperations.getRootStateOperations().setState(e)}getStoreBoundSelectorFn(e){return function ve(t){const n=function re(t){return t.NGXS_SELECTOR_META}(t)||lt(t);return n&&n.makeRootSelector||(()=>t)}(e)(this._stateFactory.getRuntimeSelectorContext())}initStateStream(e){const s=this._stateStream.value;if(!s||0===Object.keys(s).length){const f=Object.keys(this._config.defaultsState).length>0?Object.assign({},this._config.defaultsState,e):e;this._stateStream.next(f)}}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(jt),r.LFG(dt),r.LFG(ct),r.LFG(Bt),r.LFG(ht),r.LFG(b,8))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t})(),Ct=(()=>{class t{constructor(e,s){t.store=e,t.config=s}ngOnDestroy(){t.store=null,t.config=null}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(Tt),r.LFG(ct))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac}),t.store=null,t.config=null,t})();class me{static get type(){return"@@INIT"}}class He{constructor(n){this.addedStates=n}static get type(){return"@@UPDATE_STATE"}}let We=(()=>{class t{constructor(e,s,o,c,f=[],m){const v=e.addAndReturnDefaults(f);s.setStateToTheCurrentWithNew(v),e.connectActionHandlers(),m.ngxsBootstrap(new me,v)}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(ht),r.LFG(dt),r.LFG(Tt),r.LFG(Ct),r.LFG(N,8),r.LFG(ce))},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({}),t})(),Ke=(()=>{class t{constructor(e,s,o,c=[],f){const m=t.flattenStates(c),v=o.addAndReturnDefaults(m);v.states.length&&(s.setStateToTheCurrentWithNew(v),f.ngxsBootstrap(new He(v.defaults),v))}static flattenStates(e=[]){return e.reduce((s,o)=>s.concat(o),[])}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(Tt),r.LFG(dt),r.LFG(ht),r.LFG(Y,8),r.LFG(ce))},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({}),t})();class j{static forRoot(n=[],e={}){return{ngModule:We,providers:[ht,zt,Le,kt,p,ce,ge,ae,dt,Bt,Tt,jt,Ct,ie,...n,...j.ngxsTokenProviders(n,e)]}}static forFeature(n=[]){return{ngModule:Ke,providers:[ht,ie,...n,{provide:Y,multi:!0,useValue:n}]}}static ngxsTokenProviders(n,e){return[{provide:le,useValue:e.executionStrategy},{provide:N,useValue:n},{provide:j.ROOT_OPTIONS,useValue:e},{provide:ct,useFactory:j.ngxsConfigFactory,deps:[j.ROOT_OPTIONS]},{provide:r.tb,useFactory:j.appBootstrapListenerFactory,multi:!0,deps:[p]},{provide:b,useFactory:j.getInitialState},{provide:K,useExisting:zt},{provide:$,useExisting:ht}]}static ngxsConfigFactory(n){return ne(new ct,n)}static appBootstrapListenerFactory(n){return()=>n.bootstrap()}static getInitialState(){return U.pop()}}function Ve(t,n){return(e,s)=>{const o=se(e.constructor);Array.isArray(t)||(t=[t]);for(const c of t){const f=c.type;o.actions[f]||(o.actions[f]=[]),o.actions[f].push({fn:s,options:n||{},type:f})}}}function Ye(t){return s=>{const o=s,c=se(o),f=Object.getPrototypeOf(o),m=function n(s){return Object.assign({},s[ue]||{},t)}(f);(function e(s){const{meta:o,inheritedStateClass:c,optionsWithInheritance:f}=s,{children:m,defaults:v,name:P}=f,D="string"==typeof P?P:P&&P.getName()||null;c.hasOwnProperty(X)&&(o.actions=Object.assign({},o.actions,(c[X]||{}).actions)),o.children=m,o.defaults=v,o.name=D})({meta:c,inheritedStateClass:f,optionsWithInheritance:m}),o[ue]=m}}function qe(t,...n){return function(e,s){const o=s.toString(),c=`__${o}__selector`,f=function Je(t,n,e=[]){return n=n||function Qe(t){const n=t.length-1;return 36===t.charCodeAt(n)?t.slice(0,n):t}(t),"string"==typeof n?de(e.length?[n,...e]:n.split("."),Ct.config):n}(o,t,n);Object.defineProperties(e,{[c]:{writable:!0,enumerable:!1,configurable:!0},[o]:{enumerable:!0,configurable:!0,get(){return this[c]||(this[c]=function Ze(t){return Ct.store||function h(){throw new Error("You have forgotten to import the NGXS module!")}(),Ct.store.select(t)}(f))}}})}}j.\u0275fac=function(n){return new(n||j)},j.\u0275mod=r.oAB({type:j}),j.\u0275inj=r.cJS({}),j.ROOT_OPTIONS=new r.OlP("ROOT_OPTIONS")},262:(z,w,u)=>{u.d(w,{K:()=>O});var r=u(8421),_=u(5403),F=u(4482);function O(M){return(0,F.e)((p,g)=>{let b,y=null,S=!1;y=p.subscribe((0,_.x)(g,void 0,void 0,U=>{b=(0,r.Xf)(M(U,O(M)(p))),y?(y.unsubscribe(),y=null,b.subscribe(g)):S=!0})),S&&(y.unsubscribe(),y=null,b.subscribe(g))})}},9300:(z,w,u)=>{u.d(w,{h:()=>F});var r=u(4482),_=u(5403);function F(O,M){return(0,r.e)((p,g)=>{let y=0;p.subscribe((0,_.x)(g,S=>O.call(M,S,y++)&&g.next(S)))})}},8505:(z,w,u)=>{u.d(w,{b:()=>M});var r=u(576),_=u(4482),F=u(5403),O=u(4671);function M(p,g,y){const S=(0,r.m)(p)||g||y?{next:p,error:g,complete:y}:p;return S?(0,_.e)((b,U)=>{var K;null===(K=S.subscribe)||void 0===K||K.call(S);let $=!0;b.subscribe((0,F.x)(U,L=>{var A;null===(A=S.next)||void 0===A||A.call(S,L),U.next(L)},()=>{var L;$=!1,null===(L=S.complete)||void 0===L||L.call(S),U.complete()},L=>{var A;$=!1,null===(A=S.error)||void 0===A||A.call(S,L),U.error(L)},()=>{var L,A;$&&(null===(L=S.unsubscribe)||void 0===L||L.call(S)),null===(A=S.finalize)||void 0===A||A.call(S)}))}):O.y}},4408:(z,w,u)=>{u.d(w,{o:()=>M});var r=u(727);class _ extends r.w0{constructor(g,y){super()}schedule(g,y=0){return this}}const F={setInterval(p,g,...y){const{delegate:S}=F;return S?.setInterval?S.setInterval(p,g,...y):setInterval(p,g,...y)},clearInterval(p){const{delegate:g}=F;return(g?.clearInterval||clearInterval)(p)},delegate:void 0};var O=u(8737);class M extends _{constructor(g,y){super(g,y),this.scheduler=g,this.work=y,this.pending=!1}schedule(g,y=0){var S;if(this.closed)return this;this.state=g;const b=this.id,U=this.scheduler;return null!=b&&(this.id=this.recycleAsyncId(U,b,y)),this.pending=!0,this.delay=y,this.id=null!==(S=this.id)&&void 0!==S?S:this.requestAsyncId(U,this.id,y),this}requestAsyncId(g,y,S=0){return F.setInterval(g.flush.bind(g,this),S)}recycleAsyncId(g,y,S=0){if(null!=S&&this.delay===S&&!1===this.pending)return y;null!=y&&F.clearInterval(y)}execute(g,y){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const S=this._execute(g,y);if(S)return S;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(g,y){let b,S=!1;try{this.work(g)}catch(U){S=!0,b=U||new Error("Scheduled action threw falsy error")}if(S)return this.unsubscribe(),b}unsubscribe(){if(!this.closed){const{id:g,scheduler:y}=this,{actions:S}=y;this.work=this.state=this.scheduler=null,this.pending=!1,(0,O.P)(S,this),null!=g&&(this.id=this.recycleAsyncId(y,g,null)),this.delay=null,super.unsubscribe()}}}},7565:(z,w,u)=>{u.d(w,{v:()=>F});var r=u(6063);class _{constructor(M,p=_.now){this.schedulerActionCtor=M,this.now=p}schedule(M,p=0,g){return new this.schedulerActionCtor(this,M).schedule(g,p)}}_.now=r.l.now;class F extends _{constructor(M,p=_.now){super(M,p),this.actions=[],this._active=!1}flush(M){const{actions:p}=this;if(this._active)return void p.push(M);let g;this._active=!0;do{if(g=M.execute(M.state,M.delay))break}while(M=p.shift());if(this._active=!1,g){for(;M=p.shift();)M.unsubscribe();throw g}}}},6063:(z,w,u)=>{u.d(w,{l:()=>r});const r={now:()=>(r.delegate||Date).now(),delegate:void 0}},3268:(z,w,u)=>{u.d(w,{Z:()=>O});var r=u(4004);const{isArray:_}=Array;function O(M){return(0,r.U)(p=>function F(M,p){return _(p)?M(...p):M(p)}(M,p))}},1035:(z,w,u)=>{u.d(w,{_F:()=>mt,yz:()=>ot,KA:()=>Lt});var r=u(2717),_=u(5980),F=u(515),O=u(8306),M=u(4408);const g=new(u(7565).v)(M.o);var S=u(4482),b=u(5403),K=u(8505),$=u(4004),L=u(9300),A=u(8421),rt=u(5577),T=u(1144),x=u(576),G=u(3268);const H=["addListener","removeListener"],W=["addEventListener","removeEventListener"],Ht=["on","off"];function gt(i,l,a,d){if((0,x.m)(a)&&(d=a,a=void 0),d)return gt(i,l,a).pipe((0,G.Z)(d));const[h,E]=function V(i){return(0,x.m)(i.addEventListener)&&(0,x.m)(i.removeEventListener)}(i)?W.map(I=>C=>i[I](l,C,a)):function Wt(i){return(0,x.m)(i.addListener)&&(0,x.m)(i.removeListener)}(i)?H.map(It(i,l)):function it(i){return(0,x.m)(i.on)&&(0,x.m)(i.off)}(i)?Ht.map(It(i,l)):[];if(!h&&(0,T.z)(i))return(0,rt.z)(I=>gt(I,l,a))((0,A.Xf)(i));if(!h)throw new TypeError("Invalid event target");return new O.y(I=>{const C=(...q)=>I.next(1<q.length?q:q[0]);return h(C),()=>E(C)})}function It(i,l){return a=>d=>i[a](l,d)}var Kt=u(7579);const yt="GET_STORE",at="STORE_UPATE",xt="STORE_INIT",tt="ACTION_DISPATCHED",St=new r.OlP("STATE_FILTER"),Pt=new r.OlP("BROADCAST_CHANNEL_NAME");class J{}const vt=new r.OlP("ALLOWED_ORIGIN"),mt=new r.OlP("KNOWN_ACTION"),Vt=new r.OlP("DEBOUNCE_TIME");function Yt(i){let l;if(Array.isArray(i)){l=[...i];const a=Object.getPrototypeOf(i);if(a!==Array.prototype){Object.setPrototypeOf(l,a);for(const d in i)!/^\d+$/.test(d)&&Object.hasOwn(i,d)&&(l[d]=i[d])}}else l=Object.create(Object.getPrototypeOf(i)),Object.assign(l,i);return l}function et(i,l){return"object"==typeof i&&"object"==typeof l&&null!==i&&null!==l?Object.getPrototypeOf(i)!==Object.getPrototypeOf(l):i!==l}function*nt(i,l,a,d){if("object"==typeof i&&i){if(a.has(i))return;a.add(i)}if("object"!=typeof i||null===i||"object"!=typeof l||null===l)i!==l&&(yield{key:d,operation:"update",value:l});else{for(let h in i){const E=d+h;i[h]!==l[h]&&(h in l?et(i[h],l[h])?yield{key:E,operation:"update",value:l[h]}:i[h]instanceof Date?i[h].getTime()!==l[h].getTime()&&(yield{key:E,operation:"update",value:l[h]}):i[h]instanceof RegExp?i[h].toString()!==l[h].toString()&&(yield{key:E,operation:"update",value:l[h]}):yield*nt(i[h],l[h],a,`${d}${h}.`):yield{key:E,operation:"remove"})}for(let h in l){const E=d+h;h in i||(yield{key:E,operation:"add",value:l[h]})}}}function Xt(i,l){return nt(i,l,new WeakSet,"")}let Q=(()=>{class i{constructor(a){this.payload=a}}return i.type="@@MESSAGE",i})(),Ot=(()=>{class i{constructor(a){this.payload=a}}return i.type="@@INIT_MESSAGE",i})(),Et=(()=>{class i{constructor(a,d){this.commsService=a,this.store=d,this.init=()=>{this.subscription&&(console.warn("ChildHandler is already initiated, will re-initiate"),this.subscription.unsubscribe()),this.subscription=this.commsService.messages$.subscribe(h=>{h.type===at?this.store.dispatch(new Q(h.payload)):h.type===xt&&this.store.dispatch(new Ot(h.payload))}),this.commsService.postMessage({type:yt})}}ngOnDestroy(){this.subscription?.unsubscribe()}}return i.\u0275fac=function(a){return new(a||i)(r.LFG(J),r.LFG(_.yh))},i.\u0275prov=r.Yz7({token:i,factory:i.\u0275fac}),i})(),Mt=(()=>{class i{constructor(a){this.commsService=a}handle(a,d,h){if(d instanceof _.XP)return h(a,d);if(d instanceof Q){if(d.payload.length>0){const E=function st(i,l){let a=Yt(i);for(let d of l){const h=d.key.split(".");let E=a;for(let C of h.slice(0,-1)){if("object"!=typeof E[C]||null===E[C])throw console.error("Invalid diff key",d.key,"does not exist in state",i,"Navigated to",E),new Error(`Invalid diff key ${d.key} does not exist in state`);E=E[C]=Yt(E[C])}let I=h.at(-1);switch(d.operation){case"add":case"update":E[I]=d.value;break;case"remove":delete E[I]}}return a}(a,d.payload);return h(E,d)}}else{if(d instanceof Ot)return h(d.payload,d);this.commsService.postMessage({type:tt,actionType:d.constructor?.type,action:d})}return F.E}}return i.\u0275fac=function(a){return new(a||i)(r.LFG(J))},i.\u0275prov=r.Yz7({token:i,factory:i.\u0275fac}),i})(),Dt=(()=>{class i{constructor(a,d,h,E,I){this.store=a,this.commsService=d,this.stateFilter=h,this.debounce=I,this.subscriptions=[],this.init=()=>{if(this.subscriptions.length)for(console.warn("HostHandler is already initiated, will re-initiate");this.subscriptions.length;)this.subscriptions.pop()?.unsubscribe();let C;this.subscriptions.push(this.commsService.messages$.subscribe(N=>{switch(N.type){case tt:this.onActionDispatched(N.actionType,N.action);break;case yt:this.onGetStore()}}));const q=new O.y(N=>{const Y=this.store.subscribe(Gt=>{N.next(Gt)});return()=>Y.unsubscribe()});this.subscriptions.push(q.pipe(this.debounce?function U(i,l=g){return(0,S.e)((a,d)=>{let h=null,E=null,I=null;const C=()=>{if(h){h.unsubscribe(),h=null;const N=E;E=null,d.next(N)}};function q(){const N=I+i,Y=l.now();if(Y<N)return h=this.schedule(void 0,N-Y),void d.add(h);C()}a.subscribe((0,b.x)(d,N=>{E=N,I=l.now(),h||(h=l.schedule(q,i),d.add(h))},()=>{C(),d.complete()},void 0,()=>{E=h=null}))})}(this.debounce):(0,K.b)(()=>{}),(0,$.U)(N=>this.filterState(N)),(0,$.U)(N=>{const Y=Array.from(Xt(C,N));return C=N,Y}),(0,L.h)(N=>N.length>0)).subscribe(N=>{this.commsService.postMessage({type:at,payload:N})}))},this.debounce??(this.debounce=100),this.knownActions=new Map(E?.flat().map(C=>[C.type,C]))}filterState(a){if("function"==typeof this.stateFilter)return this.stateFilter(a);if(this.stateFilter instanceof RegExp){const d=this.stateFilter;return Object.fromEntries(Object.entries(a).filter(([h])=>d.test(h)))}return a}onGetStore(){this.commsService.postMessage({type:xt,payload:this.filterState(this.store.snapshot())})}onActionDispatched(a,d){var h;if(a){const E=this.knownActions.get(a),I=E?Object.create(E.prototype):new((h=class{}).type=a,h);this.store.dispatch(Object.assign(I,d))}else this.store.dispatch(d)}ngOnDestroy(){for(const a of this.subscriptions)a.unsubscribe()}}return i.\u0275fac=function(a){return new(a||i)(r.LFG(_.yh),r.LFG(J),r.LFG(St,8),r.LFG(mt,8),r.LFG(Vt,8))},i.\u0275prov=r.Yz7({token:i,factory:i.\u0275fac}),i})();function Nt(i){if("string"==typeof i?.data?.type){switch(i.data.type){case tt:case yt:case at:break;default:console.warn("Unknown message type.",i.data)}return!0}return console.warn("Invalid message event",i),!1}let Jt=(()=>{class i{constructor(a){this.channel=new BroadcastChannel(a),this.messages$=gt(this.channel,"message").pipe((0,L.h)(Nt),(0,$.U)(d=>d.data))}postMessage(a){this.channel.postMessage(a)}}return i.\u0275fac=function(a){return new(a||i)(r.LFG(Pt))},i.\u0275prov=r.Yz7({token:i,factory:i.\u0275fac}),i})();const _t="PORT_SETUP",Rt="PORT_TEARDOWN";let ot=(()=>{class i{constructor(){this.$messages=new Kt.x,this.ports=new Map,this.messages$=this.$messages.asObservable(),this.eventSourcesChanged=new r.vpe,this.handleMessage=a=>{if(a.data===Rt){const d=a.source??a.target;d&&(this.ports.delete(d),d.removeEventListener("message",this.handleMessage),d.close())}else Nt(a)&&this.$messages.next(a.data)},window.addEventListener("unload",()=>this.ngOnDestroy(!1))}get eventSources(){return this.ports.values()}addPort(a,d){this.ports.set(a,d),this.eventSourcesChanged.emit(),a.addEventListener("message",this.handleMessage),a.start()}removePort(a,d=!0){a.postMessage(Rt),a.removeEventListener("message",this.handleMessage),a.close(),d&&(this.ports.delete(a),this.eventSourcesChanged.emit())}ngOnDestroy(a=!0){for(const d of this.ports.keys())this.removePort(d,!1);a&&this.ports.clear(),this.$messages.complete()}postMessage(a){for(const d of this.ports.keys())d.postMessage(a)}}return i.\u0275fac=function(a){return new(a||i)},i.\u0275prov=r.Yz7({token:i,factory:i.\u0275fac}),i})(),Qt=(()=>{class i extends ot{constructor(a){super(),a??(a=location.origin);const d=new MessageChannel;if(window.opener)this.addPort(d.port1,window.opener),window.opener.postMessage(_t,a,[d.port2]);else{if(window.parent===window)throw new Error("Unable to connect to store host");this.addPort(d.port1,window.parent),window.parent.postMessage(_t,a,[d.port2])}}}return i.\u0275fac=function(a){return new(a||i)(r.LFG(vt,8))},i.\u0275prov=r.Yz7({token:i,factory:i.\u0275fac}),i})(),qt=(()=>{class i extends ot{constructor(a){super(),a??(a=location.origin);const d=new Set("string"==typeof a?[a]:a.flat());window.addEventListener("message",h=>{!d.has("*")&&!d.has(h.origin)||h.data===_t&&this.addPort(h.ports[0],h.source)})}}return i.\u0275fac=function(a){return new(a||i)(r.LFG(vt,8))},i.\u0275prov=r.Yz7({token:i,factory:i.\u0275fac}),i})();function bt(i,l){const a=[];return i?(a.push(Dt),l?.filter&&a.push({provide:St,useValue:l.filter})):a.push(Et,{provide:_.fN,useClass:Mt,multi:!0}),l?.knownActions instanceof Array&&a.push({provide:mt,useValue:l.knownActions,multi:!0}),"broadcast"===l?.messageHandler?a.push({provide:J,useClass:Jt},{provide:Pt,useValue:l.broadcastChannelName??"NGXS Messages"}):typeof l?.messageHandler>"u"||"port"===l.messageHandler?(a.push({provide:ot,useClass:i?qt:Qt},{provide:J,useExisting:ot}),l?.origin&&a.push({provide:vt,useValue:l.origin})):a.push({provide:J,useExisting:l.messageHandler}),{ngModule:Lt,providers:a}}let Lt=(()=>{class i{constructor(a,d){a?.init()??d?.init()}static forChild(a){return bt(!1,a)}static forRoot(a){return bt(!0,a)}}return i.\u0275fac=function(a){return new(a||i)(r.LFG(Dt,8),r.LFG(Et,8))},i.\u0275mod=r.oAB({type:i}),i.\u0275inj=r.cJS({}),i})()}}]);